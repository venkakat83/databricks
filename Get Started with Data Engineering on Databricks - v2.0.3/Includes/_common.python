{"version":"NotebookV1","origId":2730474723967963,"name":"_common","language":"python","commands":[{"version":"CommandV1","origId":2730474723967964,"guid":"571093cb-32b5-4f8e-8d76-003e360f6d5c","subtype":"command","commandType":"auto","position":2.0,"command":"def __validate_libraries():\n    import requests\n    try:\n        site = \"https://github.com/databricks-academy/dbacademy\"\n        response = requests.get(site)\n        error = f\"Unable to access GitHub or PyPi resources (HTTP {response.status_code} for {site}).\"\n        assert response.status_code == 200, \"{error} Please see the \\\"Troubleshooting | {section}\\\" section of the \\\"Version Info\\\" notebook for more information.\".format(error=error, section=\"Cannot Install Libraries\")\n    except Exception as e:\n        if type(e) is AssertionError: raise e\n        error = f\"Unable to access GitHub or PyPi resources ({site}).\"\n        raise AssertionError(\"{error} Please see the \\\"Troubleshooting | {section}\\\" section of the \\\"Version Info\\\" notebook for more information.\".format(error=error, section=\"Cannot Install Libraries\")) from e\n\ndef __install_libraries():\n    global pip_command\n    \n    specified_version = f\"Build-Scripts\"\n    key = \"dbacademy.library.version\"\n    version = spark.conf.get(key, specified_version)\n\n    if specified_version != version:\n        print(\"** Dependency Version Overridden *******************************************************************\")\n        print(f\"* This course was built for {specified_version} of the DBAcademy Library, but it is being overridden via the Spark\")\n        print(f\"* configuration variable \\\"{key}\\\". The use of version Build-Scripts is not advised as we\")\n        print(f\"* cannot guarantee compatibility with this version of the course.\")\n        print(\"****************************************************************************************************\")\n\n    try:\n        from dbacademy import dbgems  \n        installed_version = dbgems.lookup_current_module_version(\"dbacademy\")\n        if installed_version == version:\n            pip_command = \"list --quiet\"  # Skipping pip install of pre-installed python library\n        else:\n            print(f\"WARNING: The wrong version of dbacademy is attached to this cluster. Expected {version}, found {installed_version}.\")\n            print(f\"Installing the correct version.\")\n            raise Exception(\"Forcing re-install\")\n\n    except Exception as e:\n        # The import fails if library is not attached to cluster\n        if not version.startswith(\"v\"): library_url = f\"git+https://github.com/databricks-academy/dbacademy@{version}\"\n        else: library_url = f\"https://github.com/databricks-academy/dbacademy/releases/download/{version}/dbacademy-{version[1:]}-py3-none-any.whl\"\n\n        default_command = f\"install --quiet --disable-pip-version-check {library_url}\"\n        pip_command = spark.conf.get(\"dbacademy.library.install\", default_command)\n\n        if pip_command != default_command:\n            print(f\"WARNING: Using alternative library installation:\\n| default: %pip {default_command}\\n| current: %pip {pip_command}\")\n        else:\n            # We are using the default libraries; next we need to verify that we can reach those libraries.\n            __validate_libraries()\n\n__install_libraries()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"92d5082d-6800-41b1-b5ed-adea68183c24"},{"version":"CommandV1","origId":2730474723967965,"guid":"d3739ed5-deca-4bd8-afb8-f4ed5c282651","subtype":"command","commandType":"auto","position":3.0,"command":"%pip $pip_command","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5693d1a9-c6f9-4782-a73a-2f62be06f380"},{"version":"CommandV1","origId":2730474723967966,"guid":"7c4e2aed-aebf-48c1-9d3b-0604d13e19c3","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./_dataset_index","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f59b6120-c1b3-4e6a-8afc-1476090b9e39"},{"version":"CommandV1","origId":2730474723967967,"guid":"367c1281-4964-410a-b9e0-25df7a68385c","subtype":"command","commandType":"auto","position":5.0,"command":"from dbacademy import dbgems\nfrom dbacademy.dbhelper import DBAcademyHelper, Paths, CourseConfig, LessonConfig\n\ncourse_config = CourseConfig(course_code = \"gswdeod\",\n                             course_name = \"get-started-with-data-engineering-on-databricks\",\n                             data_source_name = \"get-started-with-data-engineering-on-databricks\",\n                             data_source_version = \"v01\",\n                             install_min_time = \"1 min\",\n                             install_max_time = \"5 min\",\n                             remote_files = remote_files,\n                             supported_dbrs = [\"13.2.x-scala2.12\", \"13.2.x-photon-scala2.12\", \"13.2.x-cpu-ml-scala2.12\"],\n                             expected_dbrs = \"13.2.x-scala2.12, 13.2.x-photon-scala2.12, 13.2.x-cpu-ml-scala2.12\")\n\n\nlesson_config = LessonConfig(name = None,\n                             create_schema = False,\n                             create_catalog = True,\n                             requires_uc = True,\n                             installing_datasets = True,\n                             enable_streaming_support = False,\n                             enable_ml_support = False)\n","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9e2e6f3-6b86-45bf-8394-d58a437dabe0"}],"dashboards":[],"guid":"b1b55f88-b151-4577-ad1f-5099d41da848","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{},"reposExportFormat":"SOURCE"}